import{d as L,o as i,c as b,t as y,n as I,_ as q,e as x,w as p,f as C,b as t,F as M,r as z,g as m,B,u as T,s as V,h as f,i as A,j as k,k as D,U as F,P as E,l as P,C as X,p as R,a as W,m as Z}from"./index-4918fe3f.js";const ee="/light-users-system/assets/update-9339d31a.svg",se=["disabled"],te=L({__name:"Arrow",props:{direction:{type:String,required:!0},isActive:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1}},setup(r){const _=r;return(a,v)=>(i(),b("button",{class:I(["arrow",{arrow_active:_.isActive,arrow_disabled:_.isDisabled}]),type:"button",disabled:r.isDisabled},y(r.direction==="up"?"▲":"▼"),11,se))}});const $=q(te,[["__scopeId","data-v-f32873c5"]]),ne={class:"app-pagination"},ae={class:"app-pagination__list"},le=L({__name:"AppPagination",props:{quantityOfPages:{type:Number,required:!0},currentPage:{type:Number,required:!0}},emits:["click-page"],setup(r,{emit:_}){const a=r,v=x(()=>{const{currentPage:u,quantityOfPages:o}=a;if(o<=3){const l=[];for(let d=1;d<=o;d++)l.push(d);return l}return u===1?[1,2,3]:u===o?[o-2,o-1,o]:[u-1,u,u+1]}),c=x(()=>a.quantityOfPages>3);return(u,o)=>(i(),b("div",ne,[c.value?(i(),b("button",{key:0,class:I(["app-pagination__arrow-button",{"app-pagination__arrow-button_disabled":a.currentPage===1}]),onClick:o[0]||(o[0]=p(l=>_("click-page",a.currentPage-1),["prevent"]))}," ◀ ",2)):C("",!0),t("ul",ae,[(i(!0),b(M,null,z(v.value,l=>(i(),b("li",{key:l,class:"app-pagination__list-item"},[m(B,{text:String(l),type:"button",class:I(["app-pagination__list-button",{"app-pagination__list-button_active":l===a.currentPage}]),onClick:p(d=>_("click-page",l),["prevent"])},null,8,["text","class","onClick"])]))),128))]),c.value?(i(),b("button",{key:1,class:I(["app-pagination__arrow-button",{"app-pagination__arrow-button_disabled":a.currentPage===a.quantityOfPages}]),onClick:o[1]||(o[1]=p(l=>_("click-page",a.currentPage+1),["prevent"]))}," ▶ ",2)):C("",!0)]))}});const oe=q(le,[["__scopeId","data-v-8e75c5cc"]]),w=r=>(R("data-v-7cbf008c"),r=r(),W(),r),ie={class:"users-list"},ue={key:0,class:"users-list__popup-warning"},re={class:"users-table"},_e={class:"users-table__header"},ce={class:"users-table__column users-table__column_order"},de=["onClick"],pe=w(()=>t("img",{src:ee,alt:"update button",width:"13",height:"13",loading:"lazy"},null,-1)),ve=[pe],be=w(()=>t("th",{class:"users-table__column users-table__column_id users-table__column_mobile-hidden"}," ID ",-1)),me={class:"users-table__column users-table__column_first-name"},ge=w(()=>t("span",null,"First Name",-1)),fe={class:"users-table__column users-table__column_second-name"},he=w(()=>t("span",null,"Second Name",-1)),ye={class:"users-table__column users-table__column_e-mail users-table__column_mobile-hidden"},ke=w(()=>t("span",null,"E-mail",-1)),Ce=w(()=>t("th",{class:"users-table__column_mobile-hidden"},null,-1)),we=w(()=>t("th",{class:"users-table__column_mobile-hidden"},null,-1)),Pe={class:"users-table__column users-table__column_order"},$e={class:"users-table__column users-table__column_id users-table__column_mobile-hidden"},xe={class:"users-table__column users-table__column_first-name"},Ue={class:"users-table__column users-table__column_second-name"},Se={class:"users-table__column users-table__column_e-mail users-table__column_mobile-hidden"},Ie={class:"users-table__column users-table__column_button users-table__column_mobile-hidden"},Be={class:"users-table__column users-table__column_button users-table__column_mobile-hidden"},S=5,Le=L({__name:"UsersList",setup(r){const _=T(),{users:a}=V(_),v=f(!1),c=f(null),u=f(null),o=f(""),l=f(""),d=f(""),g=f(""),U=x(()=>{let s=null,e="";return l.value?(s="first_name",e=l.value):d.value?(s="second_name",e=d.value):g.value&&(s="e_mail",e=g.value),s?j(s,e):a.value}),Y=()=>{l.value="",d.value="",g.value=""},j=(s,e)=>e==="up"?[...a.value].sort((n,h)=>n[s].localeCompare(h[s])):[...a.value].sort((n,h)=>h[s].localeCompare(n[s]));A(l,s=>{s&&(d.value="",g.value="")}),A(d,s=>{s&&(l.value="",g.value="")}),A(g,s=>{s&&(l.value="",d.value="")});const G=async s=>{try{await _.addUser(s),v.value=!1}catch(e){e instanceof Error&&e.message?o.value=e.message:o.value="Some problems with creating new user.",setTimeout(()=>{o.value=""},3e3)}},H=s=>{const e=u.value;e&&_.editUser(s,e),u.value=null},J=s=>{_.deleteUser(s),c.value=null},N=f(1),O=x(()=>Math.ceil(U.value.length/S)),K=x(()=>{if(U.value.length<=S)return U.value;const s=(N.value-1)*S;return U.value.slice(s,s+S)}),Q=s=>{N.value=s};return(s,e)=>(i(),b("div",ie,[m(B,{text:"Create User",type:"button",onClick:e[0]||(e[0]=p(n=>v.value=!0,["prevent"])),class:"users-list__create-button"}),v.value?(i(),k(E,{key:0,onClosePopup:e[1]||(e[1]=n=>v.value=!1)},{default:D(()=>[o.value?(i(),b("h3",ue,y(o.value),1)):(i(),k(F,{key:1,"button-text":"Register",onUserData:G}))]),_:1})):C("",!0),t("table",re,[t("thead",null,[t("tr",_e,[t("th",ce,[t("button",{class:"users-table__update-button",onClick:p(Y,["prevent"])},ve,8,de)]),be,t("th",me,[m($,{direction:"up","is-active":l.value==="up","is-disabled":!P(a).length,onClick:e[2]||(e[2]=p(n=>l.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),m($,{direction:"down","is-active":l.value==="down","is-disabled":!P(a).length,onClick:e[3]||(e[3]=p(n=>l.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),ge]),t("th",fe,[m($,{direction:"up","is-active":d.value==="up","is-disabled":!P(a).length,onClick:e[4]||(e[4]=p(n=>d.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),m($,{direction:"down","is-active":d.value==="down","is-disabled":!P(a).length,onClick:e[5]||(e[5]=p(n=>d.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),he]),t("th",ye,[m($,{direction:"up","is-active":g.value==="up","is-disabled":!P(a).length,onClick:e[6]||(e[6]=p(n=>g.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),m($,{direction:"down","is-active":g.value==="down","is-disabled":!P(a).length,onClick:e[7]||(e[7]=p(n=>g.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),ke]),Ce,we])]),t("tbody",null,[(i(!0),b(M,null,z(K.value,n=>(i(),b("tr",{key:n.id,class:"users-table__row"},[t("td",Pe,y(n.order),1),t("td",$e,y(n.id),1),t("td",xe,y(n.first_name),1),t("td",Ue,y(n.second_name),1),t("td",Se,y(n.e_mail),1),t("td",Ie,[m(B,{text:"Edit",type:"button",onClick:p(h=>u.value=u.value?null:n.id,["stop","prevent"]),class:"users-table__button"},null,8,["onClick"]),u.value===n.id?(i(),k(E,{key:0,onClosePopup:e[8]||(e[8]=h=>u.value=null)},{default:D(()=>[m(F,{"button-text":"Update","first-name":n.first_name,"second-name":n.second_name,"e-mail":n.e_mail,"show-password":!1,onUserData:H},null,8,["first-name","second-name","e-mail"])]),_:2},1024)):C("",!0)]),t("td",Be,[m(B,{text:"Delete",type:"button",onClick:p(h=>c.value=c.value?null:n.id,["stop","prevent"]),class:"users-table__button"},null,8,["onClick"]),c.value===n.id?(i(),k(X,{key:0,onClickNo:e[9]||(e[9]=h=>c.value=null),onClickYes:h=>J(n.id),text:"Are you sure?"},null,8,["onClickYes"])):C("",!0)])]))),128))])]),O.value>1?(i(),k(oe,{key:1,"quantity-of-pages":O.value,"current-page":N.value,onClickPage:Q},null,8,["quantity-of-pages","current-page"])):C("",!0)]))}});const qe=q(Le,[["__scopeId","data-v-7cbf008c"]]);const Ne={},Ae=r=>(R("data-v-db0efc3c"),r=r(),W(),r),De={class:"loader"},Ee=Ae(()=>t("div",{class:"loader__spinner"},null,-1)),Oe=[Ee];function Fe(r,_){return i(),b("div",De,Oe)}const Me=q(Ne,[["render",Fe],["__scopeId","data-v-db0efc3c"]]),ze={class:"users-list-page"},Te={class:"users-list-page__error-container"},Ve=t("span",{class:"users-list-page__error-sign"},"✖",-1),Re={class:"users-list-page__error-text"},Ye=L({__name:"UsersListPage",setup(r){const _=T(),{users:a}=V(_),v=f(!1),c=f(null);return Z(async()=>{if(!a.value.length)try{v.value=!0,await _.initializeUsers(),c.value=null}catch(u){u instanceof Error?c.value=u.message:c.value="Error: loading users data"}finally{v.value=!1}}),(u,o)=>(i(),b("div",ze,[v.value?(i(),k(Me,{key:0})):c.value?(i(),k(E,{key:1,onClosePopup:o[0]||(o[0]=l=>c.value=null)},{default:D(()=>[t("div",Te,[Ve,t("p",Re,y(c.value),1)])]),_:1})):C("",!0),v.value?C("",!0):(i(),k(qe,{key:2}))]))}});export{Ye as default};
