import{d as D,o,c as b,t as p,n as W,_ as N,u as E,s as F,r as m,e as Y,w as S,f as d,g as v,B,h as f,i as I,U as P,P as L,j as U,b as t,k as w,F as j,l as q,C as G,p as A,a as M,m as H}from"./index-3767277b.js";const J=["disabled"],K=D({__name:"Arrow",props:{direction:{type:String,required:!0},isActive:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1}},setup(n){const _=n;return(u,c)=>(o(),b("button",{class:W(["arrow",{arrow_active:_.isActive,arrow_disabled:_.isDisabled}]),type:"button",disabled:n.isDisabled},p(n.direction==="up"?"▲":"▼"),11,J))}});const C=N(K,[["__scopeId","data-v-be1cba72"]]),h=n=>(A("data-v-95c85efc"),n=n(),M(),n),Q={class:"users-list"},X={key:0,class:"users-list__popup-warning"},Z={class:"users-table"},ee={class:"users-table__header"},se=h(()=>t("th",{class:"users-table__column users-table__column_order"}," № ",-1)),te=h(()=>t("th",{class:"users-table__column users-table__column_id users-table__column_mobile-hidden"}," ID ",-1)),le={class:"users-table__column users-table__column_first-name"},ae=h(()=>t("span",null,"First Name",-1)),ne={class:"users-table__column users-table__column_second-name"},oe=h(()=>t("span",null,"Second Name",-1)),ie={class:"users-table__column users-table__column_e-mail users-table__column_mobile-hidden"},ue=h(()=>t("span",null,"E-mail",-1)),re=h(()=>t("th",{class:"users-table__column_mobile-hidden"},null,-1)),_e=h(()=>t("th",{class:"users-table__column_mobile-hidden"},null,-1)),ce={class:"users-table__column users-table__column_order"},de={class:"users-table__column users-table__column_id users-table__column_mobile-hidden"},ve={class:"users-table__column users-table__column_first-name"},me={class:"users-table__column users-table__column_second-name"},pe={class:"users-table__column users-table__column_e-mail users-table__column_mobile-hidden"},be={class:"users-table__column users-table__column_button users-table__column_mobile-hidden"},fe={class:"users-table__column users-table__column_button users-table__column_mobile-hidden"},he=D({__name:"UsersList",setup(n){const _=E(),{users:u}=F(_),c=m(!1),a=m(""),i=m(""),r=m(""),y=m(null),g=m(null),k=m(""),T=Y(()=>{let l=null,e="";return a.value?(l="first_name",e=a.value):i.value?(l="second_name",e=i.value):r.value&&(l="e_mail",e=r.value),l?V(l,e):u.value}),V=(l,e)=>e==="up"?[...u.value].sort((s,$)=>s[l].localeCompare($[l])):[...u.value].sort((s,$)=>$[l].localeCompare(s[l]));S(a,l=>{l&&(i.value="",r.value="")}),S(i,l=>{l&&(a.value="",r.value="")}),S(r,l=>{l&&(a.value="",i.value="")});const z=async l=>{try{await _.addUser(l),c.value=!1}catch(e){e instanceof Error&&e.message?k.value=e.message:k.value="Some problems with creating new user.",setTimeout(()=>{k.value=""},3e3)}},O=l=>{const e=g.value;e&&_.editUser(l,e),g.value=null},R=l=>{_.deleteUser(l),y.value=null};return(l,e)=>(o(),b("div",Q,[d(B,{text:"Create User",type:"button",onClick:e[0]||(e[0]=v(s=>c.value=!0,["prevent"])),class:"users-list__create-button"}),c.value?(o(),f(L,{key:0,onClosePopup:e[1]||(e[1]=s=>c.value=!1)},{default:I(()=>[k.value?(o(),b("h3",X,p(k.value),1)):(o(),f(P,{key:1,"button-text":"Register",onUserData:z}))]),_:1})):U("",!0),t("table",Z,[t("thead",null,[t("tr",ee,[se,te,t("th",le,[d(C,{direction:"up","is-active":a.value==="up","is-disabled":!w(u).length,onClick:e[2]||(e[2]=v(s=>a.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),d(C,{direction:"down","is-active":a.value==="down","is-disabled":!w(u).length,onClick:e[3]||(e[3]=v(s=>a.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),ae]),t("th",ne,[d(C,{direction:"up","is-active":i.value==="up","is-disabled":!w(u).length,onClick:e[4]||(e[4]=v(s=>i.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),d(C,{direction:"down","is-active":i.value==="down","is-disabled":!w(u).length,onClick:e[5]||(e[5]=v(s=>i.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),oe]),t("th",ie,[d(C,{direction:"up","is-active":r.value==="up","is-disabled":!w(u).length,onClick:e[6]||(e[6]=v(s=>r.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),d(C,{direction:"down","is-active":r.value==="down","is-disabled":!w(u).length,onClick:e[7]||(e[7]=v(s=>r.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),ue]),re,_e])]),t("tbody",null,[(o(!0),b(j,null,q(T.value,(s,$)=>(o(),b("tr",{key:s.id,class:"users-table__row"},[t("td",ce,p($+1),1),t("td",de,p(s.id),1),t("td",ve,p(s.first_name),1),t("td",me,p(s.second_name),1),t("td",pe,p(s.e_mail),1),t("td",be,[d(B,{text:"Edit",type:"button",onClick:v(x=>g.value=g.value?null:s.id,["stop","prevent"]),class:"users-table__button"},null,8,["onClick"]),g.value===s.id?(o(),f(L,{key:0,onClosePopup:e[8]||(e[8]=x=>g.value=null)},{default:I(()=>[d(P,{"button-text":"Update","first-name":s.first_name,"second-name":s.second_name,"e-mail":s.e_mail,"show-password":!1,onUserData:O},null,8,["first-name","second-name","e-mail"])]),_:2},1024)):U("",!0)]),t("td",fe,[d(B,{text:"Delete",type:"button",onClick:v(x=>y.value=y.value?null:s.id,["stop","prevent"]),class:"users-table__button"},null,8,["onClick"]),y.value===s.id?(o(),f(G,{key:0,onClickNo:e[9]||(e[9]=x=>y.value=null),onClickYes:x=>R(s.id),text:"Are you sure?"},null,8,["onClickYes"])):U("",!0)])]))),128))])])]))}});const ye=N(he,[["__scopeId","data-v-95c85efc"]]);const ge={},we=n=>(A("data-v-997c1a58"),n=n(),M(),n),Ce={class:"loader"},ke=we(()=>t("div",{class:"loader__spinner"},null,-1)),$e=[ke];function Ue(n,_){return o(),b("div",Ce,$e)}const xe=N(ge,[["render",Ue],["__scopeId","data-v-997c1a58"]]),Se={class:"users-list-page"},Be={class:"users-list-page__error-container"},Ie=t("span",{class:"users-list-page__error-sign"},"✖",-1),Le={class:"users-list-page__error-text"},Ne=D({__name:"UsersListPage",setup(n){const _=E(),{users:u}=F(_),c=m(!1),a=m(null);return H(async()=>{if(!u.value.length)try{c.value=!0,await _.initializeUsers(),a.value=null}catch(i){i instanceof Error?a.value=i.message:a.value="Error: loading users data"}finally{c.value=!1}}),(i,r)=>(o(),b("div",Se,[c.value?(o(),f(xe,{key:0})):a.value?(o(),f(L,{key:1,onClosePopup:r[0]||(r[0]=y=>a.value=null)},{default:I(()=>[t("div",Be,[Ie,t("p",Le,p(a.value),1)])]),_:1})):U("",!0),c.value?U("",!0):(o(),f(ye,{key:2}))]))}});export{Ne as default};
