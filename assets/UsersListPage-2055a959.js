import{d as L,o as i,c as m,t as y,n as I,_ as q,e as x,w as p,f as C,b as t,F as M,r as z,g as b,B,u as T,s as V,h as f,i as A,j as k,k as D,U as F,P as E,l as w,C as X,p as R,a as W,m as Z}from"./index-a9fe6302.js";const ee=["disabled"],se=L({__name:"Arrow",props:{direction:{type:String,required:!0},isActive:{type:Boolean,default:!1},isDisabled:{type:Boolean,default:!1}},setup(r){const _=r;return(n,v)=>(i(),m("button",{class:I(["arrow",{arrow_active:_.isActive,arrow_disabled:_.isDisabled}]),type:"button",disabled:r.isDisabled},y(r.direction==="up"?"▲":"▼"),11,ee))}});const P=q(se,[["__scopeId","data-v-a57742dd"]]),te={class:"app-pagination"},ae={class:"app-pagination__list"},ne=L({__name:"AppPagination",props:{quantityOfPages:{type:Number,required:!0},currentPage:{type:Number,required:!0}},emits:["click-page"],setup(r,{emit:_}){const n=r,v=x(()=>{const{currentPage:u,quantityOfPages:o}=n;if(o<=3){const l=[];for(let d=1;d<=o;d++)l.push(d);return l}return u===1?[1,2,3]:u===o?[o-2,o-1,o]:[u-1,u,u+1]}),c=x(()=>n.quantityOfPages>3);return(u,o)=>(i(),m("div",te,[c.value?(i(),m("button",{key:0,class:I(["app-pagination__arrow-button",{"app-pagination__arrow-button_disabled":n.currentPage===1}]),onClick:o[0]||(o[0]=p(l=>_("click-page",n.currentPage-1),["prevent"]))}," ◀ ",2)):C("",!0),t("ul",ae,[(i(!0),m(M,null,z(v.value,l=>(i(),m("li",{key:l,class:"app-pagination__list-item"},[b(B,{text:String(l),type:"button",class:I(["app-pagination__list-button",{"app-pagination__list-button_active":l===n.currentPage}]),onClick:p(d=>_("click-page",l),["prevent"])},null,8,["text","class","onClick"])]))),128))]),c.value?(i(),m("button",{key:1,class:I(["app-pagination__arrow-button",{"app-pagination__arrow-button_disabled":n.currentPage===n.quantityOfPages}]),onClick:o[1]||(o[1]=p(l=>_("click-page",n.currentPage+1),["prevent"]))}," ▶ ",2)):C("",!0)]))}});const le=q(ne,[["__scopeId","data-v-72fc02d6"]]),oe="/light-users-system/assets/update-9339d31a.svg",$=r=>(R("data-v-979a9df9"),r=r(),W(),r),ie={class:"users-list"},ue={key:0,class:"users-list__popup-warning"},re={class:"users-table"},_e={class:"users-table__header"},ce={class:"users-table__column users-table__column_order"},de=["onClick"],pe=["src"],ve=$(()=>t("th",{class:"users-table__column users-table__column_id users-table__column_mobile-hidden"}," ID ",-1)),me={class:"users-table__column users-table__column_first-name"},be=$(()=>t("span",null,"First Name",-1)),ge={class:"users-table__column users-table__column_second-name"},fe=$(()=>t("span",null,"Second Name",-1)),he={class:"users-table__column users-table__column_e-mail users-table__column_mobile-hidden"},ye=$(()=>t("span",null,"E-mail",-1)),ke=$(()=>t("th",{class:"users-table__column_mobile-hidden"},null,-1)),Ce=$(()=>t("th",{class:"users-table__column_mobile-hidden"},null,-1)),we={class:"users-table__column users-table__column_order"},Pe={class:"users-table__column users-table__column_id users-table__column_mobile-hidden"},$e={class:"users-table__column users-table__column_first-name"},xe={class:"users-table__column users-table__column_second-name"},Ue={class:"users-table__column users-table__column_e-mail users-table__column_mobile-hidden"},Se={class:"users-table__column users-table__column_button users-table__column_mobile-hidden"},Ie={class:"users-table__column users-table__column_button users-table__column_mobile-hidden"},S=5,Be=L({__name:"UsersList",setup(r){const _=T(),{users:n}=V(_),v=f(!1),c=f(null),u=f(null),o=f(""),l=f(""),d=f(""),g=f(""),U=x(()=>{let s=null,e="";return l.value?(s="first_name",e=l.value):d.value?(s="second_name",e=d.value):g.value&&(s="e_mail",e=g.value),s?j(s,e):n.value}),Y=()=>{l.value="",d.value="",g.value=""},j=(s,e)=>e==="up"?[...n.value].sort((a,h)=>a[s].localeCompare(h[s])):[...n.value].sort((a,h)=>h[s].localeCompare(a[s]));A(l,s=>{s&&(d.value="",g.value="")}),A(d,s=>{s&&(l.value="",g.value="")}),A(g,s=>{s&&(l.value="",d.value="")});const G=async s=>{try{await _.addUser(s),v.value=!1}catch(e){e instanceof Error&&e.message?o.value=e.message:o.value="Some problems with creating new user.",setTimeout(()=>{o.value=""},3e3)}},H=s=>{const e=u.value;e&&_.editUser(s,e),u.value=null},J=s=>{_.deleteUser(s),c.value=null},N=f(1),O=x(()=>Math.ceil(U.value.length/S)),K=x(()=>{if(U.value.length<=S)return U.value;const s=(N.value-1)*S;return U.value.slice(s,s+S)}),Q=s=>{N.value=s};return(s,e)=>(i(),m("div",ie,[b(B,{text:"Create User",type:"button",onClick:e[0]||(e[0]=p(a=>v.value=!0,["prevent"])),class:"users-list__create-button"}),v.value?(i(),k(E,{key:0,onClosePopup:e[1]||(e[1]=a=>v.value=!1)},{default:D(()=>[o.value?(i(),m("h3",ue,y(o.value),1)):(i(),k(F,{key:1,"button-text":"Register",onUserData:G}))]),_:1})):C("",!0),t("table",re,[t("thead",null,[t("tr",_e,[t("th",ce,[t("button",{class:"users-table__update-button",onClick:p(Y,["prevent"])},[t("img",{src:w(oe),alt:"update button",width:"13",height:"13",loading:"lazy"},null,8,pe)],8,de)]),ve,t("th",me,[b(P,{direction:"up","is-active":l.value==="up","is-disabled":!w(n).length,onClick:e[2]||(e[2]=p(a=>l.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),b(P,{direction:"down","is-active":l.value==="down","is-disabled":!w(n).length,onClick:e[3]||(e[3]=p(a=>l.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),be]),t("th",ge,[b(P,{direction:"up","is-active":d.value==="up","is-disabled":!w(n).length,onClick:e[4]||(e[4]=p(a=>d.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),b(P,{direction:"down","is-active":d.value==="down","is-disabled":!w(n).length,onClick:e[5]||(e[5]=p(a=>d.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),fe]),t("th",he,[b(P,{direction:"up","is-active":g.value==="up","is-disabled":!w(n).length,onClick:e[6]||(e[6]=p(a=>g.value="up",["prevent"]))},null,8,["is-active","is-disabled"]),b(P,{direction:"down","is-active":g.value==="down","is-disabled":!w(n).length,onClick:e[7]||(e[7]=p(a=>g.value="down",["prevent"]))},null,8,["is-active","is-disabled"]),ye]),ke,Ce])]),t("tbody",null,[(i(!0),m(M,null,z(K.value,a=>(i(),m("tr",{key:a.id,class:"users-table__row"},[t("td",we,y(a.order),1),t("td",Pe,y(a.id),1),t("td",$e,y(a.first_name),1),t("td",xe,y(a.second_name),1),t("td",Ue,y(a.e_mail),1),t("td",Se,[b(B,{text:"Edit",type:"button",onClick:p(h=>u.value=u.value?null:a.id,["stop","prevent"]),class:"users-table__button"},null,8,["onClick"]),u.value===a.id?(i(),k(E,{key:0,onClosePopup:e[8]||(e[8]=h=>u.value=null)},{default:D(()=>[b(F,{"button-text":"Update","first-name":a.first_name,"second-name":a.second_name,"e-mail":a.e_mail,"show-password":!1,onUserData:H},null,8,["first-name","second-name","e-mail"])]),_:2},1024)):C("",!0)]),t("td",Ie,[b(B,{text:"Delete",type:"button",onClick:p(h=>c.value=c.value?null:a.id,["stop","prevent"]),class:"users-table__button"},null,8,["onClick"]),c.value===a.id?(i(),k(X,{key:0,onClickNo:e[9]||(e[9]=h=>c.value=null),onClickYes:h=>J(a.id),text:"Are you sure?"},null,8,["onClickYes"])):C("",!0)])]))),128))])]),O.value>1?(i(),k(le,{key:1,"quantity-of-pages":O.value,"current-page":N.value,onClickPage:Q},null,8,["quantity-of-pages","current-page"])):C("",!0)]))}});const Le=q(Be,[["__scopeId","data-v-979a9df9"]]);const qe={},Ne=r=>(R("data-v-88e91ef4"),r=r(),W(),r),Ae={class:"loader"},De=Ne(()=>t("div",{class:"loader__spinner"},null,-1)),Ee=[De];function Oe(r,_){return i(),m("div",Ae,Ee)}const Fe=q(qe,[["render",Oe],["__scopeId","data-v-88e91ef4"]]),Me={class:"users-list-page"},ze={class:"users-list-page__error-container"},Te=t("span",{class:"users-list-page__error-sign"},"✖",-1),Ve={class:"users-list-page__error-text"},We=L({__name:"UsersListPage",setup(r){const _=T(),{users:n}=V(_),v=f(!1),c=f(null);return Z(async()=>{if(!n.value.length)try{v.value=!0,await _.initializeUsers(),c.value=null}catch(u){u instanceof Error?c.value=u.message:c.value="Error: loading users data"}finally{v.value=!1}}),(u,o)=>(i(),m("div",Me,[v.value?(i(),k(Fe,{key:0})):c.value?(i(),k(E,{key:1,onClosePopup:o[0]||(o[0]=l=>c.value=null)},{default:D(()=>[t("div",ze,[Te,t("p",Ve,y(c.value),1)])]),_:1})):C("",!0),v.value?C("",!0):(i(),k(Le,{key:2}))]))}});export{We as default};
